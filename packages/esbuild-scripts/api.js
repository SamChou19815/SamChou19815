// @generated
/* eslint-disable */
// prettier-ignore
(() => {
var vt=Object.create;var E=Object.defineProperty;var Rt=Object.getOwnPropertyDescriptor;var Tt=Object.getOwnPropertyNames;var _t=Object.getPrototypeOf,$t=Object.prototype.hasOwnProperty;var X=t=>E(t,"__esModule",{value:!0});var Y=(t,e)=>{X(t);for(var r in e)E(t,r,{get:e[r],enumerable:!0})},Et=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Tt(e))!$t.call(t,n)&&n!=="default"&&E(t,n,{get:()=>e[n],enumerable:!(r=Rt(e,n))||r.enumerable});return t},p=t=>Et(X(E(t!=null?vt(_t(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);Y(exports,{constants:()=>W,default:()=>xt,utils:()=>Yt});var b=p(require("fs/promises")),f=p(require("path")),U=p(require("esbuild"));var D=p(require("fs/promises")),st=p(require("module")),k=p(require("path")),at=p(require("sass"));var Z=p(require("@mdx-js/mdx")),tt=p(require("remark-slug"));var z=({level:t,label:e})=>`${"#".repeat(t)} ${e}`,Mt=t=>{let e=[],r=!1;return t.split(`
`).filter(i=>{if(i.startsWith("```"))r=!r;else return!r}).forEach(i=>{let s=i.trim();if(!s.startsWith("#"))return;let o=0;for(;s[o]==="#";)o+=1;if(o>6)throw new Error(`Invalid Header: '${s}'`);e.push({level:o,label:s.substring(o).trim()})}),e},q=t=>{let e=Mt(t);if(e[0]==null)throw new Error("Lacking title.");if(e[0].level!==1)throw new Error(`First heading must be h1, found: ${z(e[0])}`);if(e.filter(r=>r.level===1).length>1)throw new Error("More than one h1.");return e},K=(t,e)=>{let r=t[e];if(r==null)throw new Error;let n=[],i=e+1;for(;i<t.length;){let{element:s,level:o,finishedIndex:a}=K(t,i);if(o<=r.level)break;if(o>r.level+1){let u=z({level:o,label:s.label});throw new Error(`Invalid header: ${u}. Expected Level: ${r.level+1}`)}i=a,n.push(s)}return{element:{label:r.label,children:n},level:r.level,finishedIndex:i}},kt=t=>{let e=q(t);return K(e,0).element},Q=t=>{let e=q(t)[0];if(e==null)throw new Error;return e.label},M=kt;var Ht=async(t,e)=>{let r=t.trim().split(`
`).slice(1),n;if(e){let i=r.findIndex(s=>s.trimStart().startsWith("<!--")&&s.includes("truncate"));n=r.slice(0,i).join(`
`)}else n=r.join(`
`);return n=n.trim(),`import React from 'react';
import mdx from 'esbuild-scripts/__internal-components__/mdx';
${await(0,Z.default)(n,{remarkPlugins:[tt.default]})}
MDXContent.truncated = ${e};
MDXContent.toc = ${JSON.stringify(M(t),void 0,2)};
MDXContent.additionalProperties = typeof additionalProperties === 'undefined' ? undefined : additionalProperties;
`},x=Ht;var et=p(require("fs")),Vt=[".tsx",".ts",".jsx",".mjs",".cjs",".js",".json"],rt=/()/,At=()=>({name:"esbuild-scripts-esbuild-plugin-pnp",setup(t){let{findPnpApi:e}=require("module");if(typeof e=="undefined")return;let r=process.cwd();t.onResolve({filter:rt},async n=>{let i=n.importer?n.importer:`${r}/`,s=e(i);if(!s)return;let o=n.path.lastIndexOf("?"),a=o===-1?n.path:n.path.substring(0,o),u=s.resolveRequest(a,i,{extensions:Vt,conditions:new Set(["browser","default","node","require"])});return u==null?{external:!0}:{namespace:"pnp",path:`${u}${o===-1?"":n.path.substring(o)}`}}),t.onLoad!==null&&t.onLoad({filter:rt},async n=>({contents:await et.promises.readFile(n.path,"utf8"),loader:"default"}))}}),nt=At;var ot=/^esbuild-scripts-internal\/virtual\//,jt=t=>({name:"VirtualPathResolvePlugin",setup(e){e.onResolve({filter:ot},r=>({path:r.path,namespace:"virtual-path"})),e.onLoad({filter:ot,namespace:"virtual-path"},r=>({contents:t[r.path],loader:"jsx"}))}}),it=jt;var Lt={name:"WebAppResolvePlugin",setup(t){t.onResolve({filter:/^data:/},()=>({external:!0}))}},It={name:"sass",setup(t){t.onResolve({filter:/.\.(scss|sass)$/},async e=>e.path.startsWith(".")?{path:(0,k.resolve)((0,k.dirname)(e.importer),e.path)}:{path:(0,st.createRequire)(e.importer).resolve(e.path)}),t.onLoad({filter:/.\.(scss|sass)$/},async e=>{let{css:r}=await new Promise((n,i)=>{(0,at.render)({file:e.path},(s,o)=>{s?i(s):n(o)})});return{contents:r.toString(),loader:"css",watchFiles:[e.path]}})}},Ct={name:"mdx",setup(t){t.onLoad({filter:/\.md\?truncated=true$/},async e=>({contents:await x((await(0,D.readFile)(e.path.substring(0,e.path.lastIndexOf("?")))).toString(),!0),loader:"jsx"})),t.onLoad({filter:/\.md$/},async e=>({contents:await x((await(0,D.readFile)(e.path)).toString(),!1),loader:"jsx"}))}},Ft=t=>[Lt,it(t),It,Ct,nt()],lt=Ft;var Dt=({virtualPathMappings:t,isServer:e=!1,isProd:r=!1})=>({define:{__dirname:'""',__SERVER__:String(e),"process.env.NODE_ENV":r?'"production"':'"development"'},bundle:!0,minify:!1,legalComments:"linked",platform:"browser",target:"es2019",logLevel:"error",plugins:lt(t)}),S=Dt;var W={};Y(W,{BUILD_PATH:()=>A,PAGES_PATH:()=>g,SSR_CSS_PATH:()=>O,SSR_JS_PATH:()=>V,TEMPLATE_PATH:()=>H,VIRTUAL_GENERATED_ENTRY_POINT_PATH_PREFIX:()=>T,VIRTUAL_PATH_PREFIX:()=>R,VIRTUAL_SERVER_ENTRY_PATH:()=>_});var v=p(require("path")),H=(0,v.join)(__dirname,"templates"),g=(0,v.join)("src","pages"),V=(0,v.join)("build","__ssr.jsx"),O=(0,v.join)("build","__ssr.css"),A="build",R="esbuild-scripts-internal/virtual/",T=`${R}__generated-entry-point__/`,_=`${T}__server__.jsx`;var dt=p(require("fs/promises")),j=p(require("path"));var m=p(require("fs/promises")),y=p(require("path")),B=async(t,e)=>{await(0,m.mkdir)(e,{recursive:!0}),await Promise.all((await(0,m.readdir)(e)).map(r=>(0,m.rm)((0,y.join)(e,r),{recursive:!0,force:!0}))),await Promise.all((await(0,m.readdir)(t)).map(async r=>{let n=(0,y.join)(t,r),i=(0,y.join)(e,r);await pt(n)?await B(n,i):await(0,m.copyFile)(n,i)}))},pt=t=>(0,m.lstat)(t).then(e=>e.isDirectory()),ut=async t=>Promise.all((await(0,m.readdir)(t)).flatMap(async e=>{let r=(0,y.join)(t,e);return await pt(r)?[r,...await ut(r)]:[r]})).then(e=>e.flat()),ct=async t=>(await ut(t)).map(e=>(0,y.relative)(t,e)).sort((e,r)=>e.localeCompare(r));var mt="// @generated",N=t=>t.endsWith("index")?t.substring(0,t.length-(t.endsWith("/index")?6:5)):t,ft=(t,e,r)=>r?`${t}/src/pages/${e}`:`${R}${e}`,ht=(t,e,r,n,i)=>{let s=n.filter(l=>l!==e),o=i.filter(l=>l!==e),a=(l,c)=>ft(t,l,c),u=[...s.map((l,c)=>`const RealComponent${c} = lazy(() => import('${a(l,!0)}'));`),...o.map((l,c)=>`const VirtualComponent${c} = lazy(() => import('${a(l,!1)}'));`)].join(`
`),d=a(e,r),h=[...s.map((l,c)=>`        <Route exact path="/${N(l)}"><Suspense fallback={null}><RealComponent${c} /></Suspense></Route>`),...o.map((l,c)=>`        <Route exact path="/${N(l)}"><Suspense fallback={null}><VirtualComponent${c} /></Suspense></Route>`)].join(`
`);return`${mt}
import React,{Suspense,lazy} from 'react';
import {hydrate,render} from 'react-dom';
import {BrowserRouter,Route,Switch} from 'esbuild-scripts/__internal-components__/react-router';
import Document from '${t}/src/pages/_document';
import Page from '${d}';
${u}
const element = (
  <BrowserRouter>
    <Document>
      <Switch>
        <Route exact path="/${N(e)}"><Page /></Route>
${h}
      </Switch>
    </Document>
  </BrowserRouter>
);
const rootElement = document.getElementById('root');
if (rootElement.hasChildNodes()) hydrate(element, rootElement); else render(element, rootElement);
`},Ot=(t,e,r)=>{let n=(o,a)=>ft(t,o,a),i=[...e.map((o,a)=>`import RealPage${a} from '${n(o,!0)}';`),...r.map((o,a)=>`import VirtualPage${a} from '${n(o,!1)}';`)].join(`
`),s=[...e.map((o,a)=>`'${o}': RealPage${a}`),...r.map((o,a)=>`'${o}': VirtualPage${a}`)].join(", ");return`${mt}
import React from 'react';
import {renderToString} from 'react-dom/server';
import Helmet from 'esbuild-scripts/components/Head';
import {StaticRouter} from 'esbuild-scripts/__internal-components__/react-router';
import Document from '${t}/src/pages/_document';
${i}
const map = { ${s} };
module.exports = (path) => ({
  divHTML: renderToString(
    <StaticRouter location={'/'+path}>
      <Document>{React.createElement(map[path])}</Document>
    </StaticRouter>
  ),
  noJS: map[path].noJS,
  helmet: Helmet.renderStatic(),
});
`},Wt=async()=>(await(0,dt.mkdir)(g,{recursive:!0}),(await ct(g)).map(t=>{switch((0,j.extname)(t)){case".js":case".jsx":case".ts":case".tsx":break;default:return null}return t.substring(0,t.lastIndexOf("."))}).filter(t=>t!=null&&!t.startsWith("_document"))),$=t=>Object.fromEntries(Object.entries(t).map(([e,r])=>[`${R}${e}`,r])),L=async t=>{let e=(0,j.resolve)("."),r=await Wt(),n=Object.fromEntries([...r.map(i=>[`${T}${i}.jsx`,ht(e,i,!0,r,t)]),...t.map(i=>[`${T}${i}.jsx`,ht(e,i,!1,r,t)])]);return n[_]=Ot(e,r,t),{entryPointsWithoutExtension:r,entryPointVirtualFiles:n}};var Bt=(t,e)=>e?`<script type="module" src="/${t}"><\/script>`:`<script src="/${t}"><\/script>`,Nt=(t,e)=>`<link rel="${e?"modulepreload":"preload"}" href="/${t}" />`,Ut=(t,e,r)=>{let n=[],i=[];t.forEach(a=>{!r&&a.endsWith("js")?n.push(a):a.endsWith("css")&&i.push(a)});let s=i.map(a=>`<link rel="stylesheet" href="/${a}" />`).join("")+n.map(a=>Nt(a,e)).join(""),o=n.map(a=>Bt(a,e)).join("");return{headLinks:s,bodyScriptLinks:o}},gt=(t,e)=>e==null?`<head>${t}</head>`:`<head>${[e.meta.toString(),e.title.toString(),e.link.toString(),e.script.toString(),t].join("")}</head>`,Gt=(t,e,r)=>{let{headLinks:n,bodyScriptLinks:i}=Ut(e,r,t==null?void 0:t.noJS);if(t==null){let d=gt(n),h=`<body><div id="root"></div>${i}</body>`;return`<!DOCTYPE html><html>${d}${h}</html>`}let{divHTML:s,helmet:o}=t,a=gt(n,o),u=`<body><div id="root">${s}</div>${i}</body>`;return`<!DOCTYPE html><html ${o.htmlAttributes.toString()}>${a}${u}</html>`},I=Gt;async function Pt(t,e){let r={...t,...$(e)},{outputFiles:n}=await(0,U.build)({...S({virtualPathMappings:r,isProd:!0}),entryPoints:Object.keys(t),assetNames:"assets/[name]-[hash]",chunkNames:"chunks/[name]-[hash]",entryNames:"[dir]/[name]-[hash]",minify:!0,format:"esm",splitting:!0,write:!1,outdir:"build"}),i=(0,f.resolve)("build");return await Promise.all(n.map(async s=>{await(0,b.mkdir)((0,f.dirname)(s.path),{recursive:!0}),await(0,b.writeFile)(s.path,s.contents)})),n.map(({path:s})=>(0,f.relative)(i,s))}async function Jt(t,e){await(0,U.build)({...S({virtualPathMappings:{...t,...$(e)},isServer:!0,isProd:!0}),entryPoints:[_],platform:"node",format:"cjs",legalComments:"none",outfile:V});try{return require((0,f.resolve)(V))}catch(r){return console.error("Unable to perform server side rendering since the server bundle is not correctly generated."),console.error(r),null}finally{await(0,b.unlink)(O)}}async function C(t,e){let r=new Date().getTime(),{entryPointsWithoutExtension:n,entryPointVirtualFiles:i}=await L(Object.keys(t));await B("public","build");let s,o;if(e){if([s,o]=await Promise.all([Pt(i,t),Jt(i,t)]),o==null)return!1}else s=await Pt(i,t),o=null;let a=[...n,...Object.keys(t)].map(d=>{let h=s.filter(c=>c.startsWith("chunk")||c.startsWith(d)),l=I(o==null?void 0:o(d),h,!0);return{entryPoint:d,html:l}});await Promise.all(a.map(async({entryPoint:d,html:h})=>{let l;d.endsWith("index")?l=(0,f.join)(A,`${d}.html`):l=(0,f.join)(A,d,"index.html"),await(0,b.mkdir)((0,f.dirname)(l),{recursive:!0}),await(0,b.writeFile)(l,h)}));let u=new Date().getTime()-r;return console.error(`\u26A1 Build success in ${u}ms.`),!0}var P=p(require("fs/promises")),w=p(require("path"));async function G(){await(0,P.mkdir)(g,{recursive:!0}),await Promise.all([(0,P.copyFile)((0,w.join)(H,"_document.tsx"),(0,w.join)(g,"_document.tsx")),(0,P.copyFile)((0,w.join)(H,"index.tsx"),(0,w.join)(g,"index.tsx")),(0,P.writeFile)((0,w.join)(g,"index.css"),""),(0,P.writeFile)((0,w.join)("src","types.d.ts"),`/// <reference types="esbuild-scripts" />
`),(0,P.mkdir)("public",{recursive:!0})])}var F=p(require("http")),bt=p(require("esbuild"));function Xt(t,e){if(e==null||!e.startsWith("/"))return;let r=e.substring(1);return t.find(n=>n.endsWith("index")?[n,n.substring(0,n.length-5)].includes(r):n===r)}var yt=t=>I(void 0,[`${t}.js`,`${t}.css`],!1);async function J(t){let{entryPointsWithoutExtension:e,entryPointVirtualFiles:r}=await L(Object.keys(t)),n={...r,...$(t)},i=[...e,...Object.keys(t)],s=await(0,bt.serve)({servedir:"public",port:19815},{...S({virtualPathMappings:n}),entryPoints:Object.keys(r),sourcemap:"inline",outdir:"public"}),o=(0,F.createServer)((a,u)=>{let d=Xt(i,a.url);if(d!=null){u.writeHead(200,{"Content-Type":"text/html"}),u.end(yt(d));return}let h={hostname:s.host,port:s.port,path:a.url,method:a.method,headers:a.headers},l=(0,F.request)(h,c=>{if(c.statusCode===404){u.writeHead(200,{"Content-Type":"text/html"}),u.end(yt("index"));return}u.writeHead(c.statusCode||200,c.headers),c.pipe(u,{end:!0})});a.pipe(l,{end:!0})}).listen(3e3);console.error("Serving at http://localhost:3000"),await s.wait,o.close()}var Yt={parseMarkdownHeaderTree:M,parseMarkdownTitle:Q,compileMarkdownToReact:x};function wt(){console.error("Usage:"),console.error("- esbuild-script start: start the devserver."),console.error("- esbuild-script build: generate production build."),console.error("- esbuild-script ssg: generate static site."),console.error("- esbuild-script ssg --no-js: generate static site without JS."),console.error("- esbuild-script help: display command line usages.")}async function zt(t){let e=process.argv[2]||"";switch(e){case"init":return await G(),!0;case"start":return await J(t),!0;case"ssg":return C(t,!0);case"build":return C(t,!1);case"help":case"--help":return wt(),!0;default:return console.error(`Unknown command: '${e}'`),wt(),!1}}async function xt(t){let e=t?await t():{};try{await zt(e)||(process.exitCode=1)}catch(r){console.error(r),process.exitCode=1}}0&&(module.exports={constants,utils});
})();
//# sourceMappingURL=api.js.map

// @generated
/* eslint-disable */
// prettier-ignore
(() => {
var Vt=Object.create;var V=Object.defineProperty;var At=Object.getOwnPropertyDescriptor;var jt=Object.getOwnPropertyNames;var Lt=Object.getPrototypeOf,It=Object.prototype.hasOwnProperty;var et=t=>V(t,"__esModule",{value:!0});var Ct=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),rt=(t,e)=>{et(t);for(var r in e)V(t,r,{get:e[r],enumerable:!0})},Ft=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of jt(e))!It.call(t,n)&&n!=="default"&&V(t,n,{get:()=>e[n],enumerable:!(r=At(e,n))||r.enumerable});return t},m=t=>Ft(et(V(t!=null?Vt(Lt(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var pt=Ct(G=>{function v(t,e){if(typeof t=="string")return t;if(t){let r,n;if(Array.isArray(t)){for(r=0;r<t.length;r++)if(n=v(t[r],e))return n}else for(r in t)if(e.has(r))return v(t[r],e)}}function w(t,e,r){throw new Error(r?`No known conditions for "${e}" entry in "${t}" package`:`Missing "${e}" export in "${t}" package`)}function ut(t,e){return e===t?".":e[0]==="."?e:e.replace(new RegExp("^"+t+"/"),"./")}function Nt(t,e=".",r={}){let{name:n,exports:i}=t;if(i){let{browser:o,require:a,unsafe:s,conditions:c=[]}=r,u=ut(n,e);if(u[0]!=="."&&(u="./"+u),typeof i=="string")return u==="."?i:w(n,u);let d=new Set(["default",...c]);s||d.add(a?"require":"import"),s||d.add(o?"browser":"node");let l,p,H=!1;for(l in i){H=l[0]!==".";break}if(H)return u==="."?v(i,d)||w(n,u,1):w(n,u);if(p=i[u])return v(p,d)||w(n,u,1);for(l in i){if(p=l[l.length-1],p==="/"&&u.startsWith(l))return(p=v(i[l],d))?p+u.substring(l.length):w(n,u,1);if(p==="*"&&u.startsWith(l.slice(0,-1))&&u.substring(l.length-1).length>0)return(p=v(i[l],d))?p.replace("*",u.substring(l.length-1)):w(n,u,1)}return w(n,u)}}function Bt(t,e={}){let r=0,n,i=e.browser,o=e.fields||["module","main"];for(i&&!o.includes("browser")&&o.unshift("browser");r<o.length;r++)if(n=t[o[r]]){if(typeof n!="string")if(typeof n=="object"&&o[r]=="browser"){if(typeof i=="string"&&(n=n[i=ut(t.name,i)],n==null))return i}else continue;return typeof n=="string"?"./"+n.replace(/^\.?\//,""):n}}G.legacy=Bt;G.resolve=Nt});rt(exports,{constants:()=>Y,default:()=>Ht,utils:()=>me});var y=m(require("fs/promises")),h=m(require("path")),Q=m(require("esbuild"));var q=m(require("fs/promises")),ht=m(require("module")),I=m(require("path")),Pt=m(require("sass"));var at=m(require("@mdx-js/mdx")),lt=m(require("remark-slug"));var nt=({level:t,label:e})=>`${"#".repeat(t)} ${e}`,Ot=t=>{let e=[],r=!1;return t.split(`
`).filter(i=>{if(i.startsWith("```"))r=!r;else return!r}).forEach(i=>{let o=i.trim();if(!o.startsWith("#"))return;let a=0;for(;o[a]==="#";)a+=1;if(a>6)throw new Error(`Invalid Header: '${o}'`);e.push({level:a,label:o.substring(a).trim()})}),e},it=t=>{let e=Ot(t);if(e[0]==null)throw new Error("Lacking title.");if(e[0].level!==1)throw new Error(`First heading must be h1, found: ${nt(e[0])}`);if(e.filter(r=>r.level===1).length>1)throw new Error("More than one h1.");return e},ot=(t,e)=>{let r=t[e];if(r==null)throw new Error;let n=[],i=e+1;for(;i<t.length;){let{element:o,level:a,finishedIndex:s}=ot(t,i);if(a<=r.level)break;if(a>r.level+1){let c=nt({level:a,label:o.label});throw new Error(`Invalid header: ${c}. Expected Level: ${r.level+1}`)}i=s,n.push(o)}return{element:{label:r.label,children:n},level:r.level,finishedIndex:i}},Dt=t=>{let e=it(t);return ot(e,0).element},st=t=>{let e=it(t)[0];if(e==null)throw new Error;return e.label},A=Dt;var Wt=async(t,e)=>{let r=t.trim().split(`
`).slice(1),n;if(e){let i=r.findIndex(o=>o.trimStart().startsWith("<!--")&&o.includes("truncate"));n=r.slice(0,i).join(`
`)}else n=r.join(`
`);return n=n.trim(),`import React from 'react';
import mdx from 'esbuild-scripts/__internal-components__/mdx';
${await(0,at.default)(n,{remarkPlugins:[lt.default]})}
MDXContent.truncated = ${e};
MDXContent.toc = ${JSON.stringify(A(t),void 0,2)};
MDXContent.additionalProperties = typeof additionalProperties === 'undefined' ? undefined : additionalProperties;
`},R=Wt;var ct=m(require("fs"));var j=m(require("fs")),f=m(require("path")),L=m(pt()),Ut=[".tsx",".ts",".jsx",".mjs",".cjs",".js",".json"],Gt=/^(\/|\.{1,2}(\/|$))/,Jt=/^\.{0,2}\//;function qt(t,e,r){let n=(0,L.resolve)(t,e,{browser:r,require:!r});if(n!=null)return n;let i=(0,L.legacy)(t,r?{browser:r}:{browser:!1,fields:["main","module"]});return typeof i=="string"?e==="."?i:null:i&&(i[e]||i[`${e}.js`]||i[`./${e}`]||i[`./${e}.js`])||null}function Xt(t,e){let r=(0,f.normalize)(t),n=(0,f.normalize)(e);return r===n?".":(r.endsWith(f.sep)||(r=r+f.sep),n.startsWith(r)?n.slice(r.length):null)}function Yt(t,e,r){let n=e.findPackageLocator((0,f.join)(t,"internal.js"));if(n==null)throw new Error;let{packageLocation:i}=e.getPackageInformation(n),o=(0,f.join)(i,"package.json");if(!j.existsSync(o))return null;let a=JSON.parse(j.readFileSync(o,"utf8")),s=Xt(i,t);if(s==null)throw new Error;Jt.test(s)||(s=`./${s}`),s=(0,f.normalize)(s);let c=qt(a,s,r);return c!=null?(0,f.join)(i,c):null}function zt(t,e,r,n){if(Gt.test(t))return e;let i=Yt(e,r,n);return i?(0,f.normalize)(i):e}function J(t,e,r,n){let i=r.resolveToUnqualified(t,e);return i==null?null:r.resolveUnqualified(zt(t,i,r,n),{extensions:Ut})}var mt=/()/,Kt=()=>({name:"esbuild-scripts-esbuild-plugin-pnp",setup(t){let{findPnpApi:e}=require("module");if(typeof e=="undefined")return;let r=process.cwd();t.onResolve({filter:mt},async n=>{let i=n.importer?n.importer:`${r}/`,o=e(i);if(!o)return;let a=n.path.lastIndexOf("?"),s=a===-1?n.path:n.path.substring(0,a),c=J(s,i,o,t.initialOptions.platform!=="node");return c==null?{external:!0}:{namespace:"pnp",path:`${c}${a===-1?"":n.path.substring(a)}`}}),t.onLoad!==null&&t.onLoad({filter:mt},async n=>({contents:await ct.promises.readFile(n.path,"utf8"),loader:"default"}))}}),dt=Kt;var ft=/^esbuild-scripts-internal\/virtual\//,Qt=t=>({name:"VirtualPathResolvePlugin",setup(e){e.onResolve({filter:ft},r=>({path:r.path,namespace:"virtual-path"})),e.onLoad({filter:ft,namespace:"virtual-path"},r=>({contents:t[r.path],loader:"jsx"}))}}),gt=Qt;var Zt={name:"WebAppResolvePlugin",setup(t){t.onResolve({filter:/^data:/},()=>({external:!0}))}},te={name:"sass",setup(t){t.onResolve({filter:/.\.(scss|sass)$/},async e=>e.path.startsWith(".")?{path:(0,I.resolve)((0,I.dirname)(e.importer),e.path)}:{path:(0,ht.createRequire)(e.importer).resolve(e.path)}),t.onLoad({filter:/.\.(scss|sass)$/},async e=>{let{css:r}=await new Promise((n,i)=>{(0,Pt.render)({file:e.path},(o,a)=>{o?i(o):n(a)})});return{contents:r.toString(),loader:"css",watchFiles:[e.path]}})}},ee={name:"mdx",setup(t){t.onLoad({filter:/\.md\?truncated=true$/},async e=>({contents:await R((await(0,q.readFile)(e.path.substring(0,e.path.lastIndexOf("?")))).toString(),!0),loader:"jsx"})),t.onLoad({filter:/\.md$/},async e=>({contents:await R((await(0,q.readFile)(e.path)).toString(),!1),loader:"jsx"}))}},re=t=>[Zt,gt(t),te,ee,dt()],bt=re;var ne=({virtualPathMappings:t,isServer:e=!1,isProd:r=!1})=>({define:{__dirname:'""',__SERVER__:String(e),"process.env.NODE_ENV":r?'"production"':'"development"'},bundle:!0,minify:!1,legalComments:"linked",platform:"browser",target:"es2019",logLevel:"error",plugins:bt(t)}),$=ne;var Y={};rt(Y,{BUILD_PATH:()=>O,PAGES_PATH:()=>P,SSR_CSS_PATH:()=>X,SSR_JS_PATH:()=>F,TEMPLATE_PATH:()=>C,VIRTUAL_GENERATED_ENTRY_POINT_PATH_PREFIX:()=>E,VIRTUAL_PATH_PREFIX:()=>_,VIRTUAL_SERVER_ENTRY_PATH:()=>M});var T=m(require("path")),C=(0,T.join)(__dirname,"templates"),P=(0,T.join)("src","pages"),F=(0,T.join)("build","__ssr.jsx"),X=(0,T.join)("build","__ssr.css"),O="build",_="esbuild-scripts-internal/virtual/",E=`${_}__generated-entry-point__/`,M=`${E}__server__.jsx`;var St=m(require("fs/promises")),D=m(require("path"));var g=m(require("fs/promises")),x=m(require("path")),z=async(t,e)=>{await(0,g.mkdir)(e,{recursive:!0}),await Promise.all((await(0,g.readdir)(e)).map(r=>(0,g.rm)((0,x.join)(e,r),{recursive:!0,force:!0}))),await Promise.all((await(0,g.readdir)(t)).map(async r=>{let n=(0,x.join)(t,r),i=(0,x.join)(e,r);await yt(n)?await z(n,i):await(0,g.copyFile)(n,i)}))},yt=t=>(0,g.lstat)(t).then(e=>e.isDirectory()),wt=async t=>Promise.all((await(0,g.readdir)(t)).flatMap(async e=>{let r=(0,x.join)(t,e);return await yt(r)?[r,...await wt(r)]:[r]})).then(e=>e.flat()),xt=async t=>(await wt(t)).map(e=>(0,x.relative)(t,e)).sort((e,r)=>e.localeCompare(r));var vt="// @generated",K=t=>t.endsWith("index")?t.substring(0,t.length-(t.endsWith("/index")?6:5)):t,Rt=(t,e,r)=>r?`${t}/src/pages/${e}`:`${_}${e}`,$t=(t,e,r,n,i)=>{let o=n.filter(l=>l!==e),a=i.filter(l=>l!==e),s=(l,p)=>Rt(t,l,p),c=[...o.map((l,p)=>`const RealComponent${p} = lazy(() => import('${s(l,!0)}'));`),...a.map((l,p)=>`const VirtualComponent${p} = lazy(() => import('${s(l,!1)}'));`)].join(`
`),u=s(e,r),d=[...o.map((l,p)=>`        <Route exact path="/${K(l)}"><Suspense fallback={null}><RealComponent${p} /></Suspense></Route>`),...a.map((l,p)=>`        <Route exact path="/${K(l)}"><Suspense fallback={null}><VirtualComponent${p} /></Suspense></Route>`)].join(`
`);return`${vt}
import React,{Suspense,lazy} from 'react';
import {hydrate,render} from 'react-dom';
import {BrowserRouter,Route,Switch} from 'esbuild-scripts/__internal-components__/react-router';
import Document from '${t}/src/pages/_document';
import Page from '${u}';
${c}
const element = (
  <BrowserRouter>
    <Document>
      <Switch>
        <Route exact path="/${K(e)}"><Page /></Route>
${d}
      </Switch>
    </Document>
  </BrowserRouter>
);
const rootElement = document.getElementById('root');
if (rootElement.hasChildNodes()) hydrate(element, rootElement); else render(element, rootElement);
`},ie=(t,e,r)=>{let n=(a,s)=>Rt(t,a,s),i=[...e.map((a,s)=>`import RealPage${s} from '${n(a,!0)}';`),...r.map((a,s)=>`import VirtualPage${s} from '${n(a,!1)}';`)].join(`
`),o=[...e.map((a,s)=>`'${a}': RealPage${s}`),...r.map((a,s)=>`'${a}': VirtualPage${s}`)].join(", ");return`${vt}
import React from 'react';
import {renderToString} from 'react-dom/server';
import Helmet from 'esbuild-scripts/components/Head';
import {StaticRouter} from 'esbuild-scripts/__internal-components__/react-router';
import Document from '${t}/src/pages/_document';
${i}
const map = { ${o} };
module.exports = (path) => ({
  divHTML: renderToString(
    <StaticRouter location={'/'+path}>
      <Document>{React.createElement(map[path])}</Document>
    </StaticRouter>
  ),
  noJS: map[path].noJS,
  helmet: Helmet.renderStatic(),
});
`},oe=async()=>(await(0,St.mkdir)(P,{recursive:!0}),(await xt(P)).map(t=>{switch((0,D.extname)(t)){case".js":case".jsx":case".ts":case".tsx":break;default:return null}return t.substring(0,t.lastIndexOf("."))}).filter(t=>t!=null&&!t.startsWith("_document"))),k=t=>Object.fromEntries(Object.entries(t).map(([e,r])=>[`${_}${e}`,r])),W=async t=>{let e=(0,D.resolve)("."),r=await oe(),n=Object.fromEntries([...r.map(i=>[`${E}${i}.jsx`,$t(e,i,!0,r,t)]),...t.map(i=>[`${E}${i}.jsx`,$t(e,i,!1,r,t)])]);return n[M]=ie(e,r,t),{entryPointsWithoutExtension:r,entryPointVirtualFiles:n}};var se=(t,e)=>e?`<script type="module" src="/${t}"><\/script>`:`<script src="/${t}"><\/script>`,ae=(t,e)=>`<link rel="${e?"modulepreload":"preload"}" href="/${t}" />`,le=(t,e,r)=>{let n=[],i=[];t.forEach(s=>{!r&&s.endsWith("js")?n.push(s):s.endsWith("css")&&i.push(s)});let o=i.map(s=>`<link rel="stylesheet" href="/${s}" />`).join("")+n.map(s=>ae(s,e)).join(""),a=n.map(s=>se(s,e)).join("");return{headLinks:o,bodyScriptLinks:a}},Tt=(t,e)=>e==null?`<head>${t}</head>`:`<head>${[e.meta.toString(),e.title.toString(),e.link.toString(),e.script.toString(),t].join("")}</head>`,ue=(t,e,r)=>{let{headLinks:n,bodyScriptLinks:i}=le(e,r,t==null?void 0:t.noJS);if(t==null){let u=Tt(n),d=`<body><div id="root"></div>${i}</body>`;return`<!DOCTYPE html><html>${u}${d}</html>`}let{divHTML:o,helmet:a}=t,s=Tt(n,a),c=`<body><div id="root">${o}</div>${i}</body>`;return`<!DOCTYPE html><html ${a.htmlAttributes.toString()}>${s}${c}</html>`},N=ue;async function _t(t,e){let r={...t,...k(e)},{outputFiles:n}=await(0,Q.build)({...$({virtualPathMappings:r,isProd:!0}),entryPoints:Object.keys(t),assetNames:"assets/[name]-[hash]",chunkNames:"chunks/[name]-[hash]",entryNames:"[dir]/[name]-[hash]",minify:!0,format:"esm",splitting:!0,write:!1,outdir:"build"}),i=(0,h.resolve)("build");return await Promise.all(n.map(async o=>{await(0,y.mkdir)((0,h.dirname)(o.path),{recursive:!0}),await(0,y.writeFile)(o.path,o.contents)})),n.map(({path:o})=>(0,h.relative)(i,o))}async function pe(t,e){await(0,Q.build)({...$({virtualPathMappings:{...t,...k(e)},isServer:!0,isProd:!0}),entryPoints:[M],platform:"node",format:"cjs",legalComments:"none",outfile:F});try{return require((0,h.resolve)(F))}catch(r){return console.error("Unable to perform server side rendering since the server bundle is not correctly generated."),console.error(r),null}finally{await(0,y.unlink)(X)}}async function B(t,e){let r=new Date().getTime(),{entryPointsWithoutExtension:n,entryPointVirtualFiles:i}=await W(Object.keys(t));await z("public","build");let o,a;if(e){if([o,a]=await Promise.all([_t(i,t),pe(i,t)]),a==null)return!1}else o=await _t(i,t),a=null;let s=[...n,...Object.keys(t)].map(u=>{let d=o.filter(p=>p.startsWith("chunk")||p.startsWith(u)),l=N(a==null?void 0:a(u),d,!0);return{entryPoint:u,html:l}});await Promise.all(s.map(async({entryPoint:u,html:d})=>{let l;u.endsWith("index")?l=(0,h.join)(O,`${u}.html`):l=(0,h.join)(O,u,"index.html"),await(0,y.mkdir)((0,h.dirname)(l),{recursive:!0}),await(0,y.writeFile)(l,d)}));let c=new Date().getTime()-r;return console.error(`\u26A1 Build success in ${c}ms.`),!0}var b=m(require("fs/promises")),S=m(require("path"));async function Z(){await(0,b.mkdir)(P,{recursive:!0}),await Promise.all([(0,b.copyFile)((0,S.join)(C,"_document.tsx"),(0,S.join)(P,"_document.tsx")),(0,b.copyFile)((0,S.join)(C,"index.tsx"),(0,S.join)(P,"index.tsx")),(0,b.writeFile)((0,S.join)(P,"index.css"),""),(0,b.writeFile)((0,S.join)("src","types.d.ts"),`/// <reference types="esbuild-scripts" />
`),(0,b.mkdir)("public",{recursive:!0})])}var U=m(require("http")),Et=m(require("esbuild"));function ce(t,e){if(e==null||!e.startsWith("/"))return;let r=e.substring(1);return t.find(n=>n.endsWith("index")?[n,n.substring(0,n.length-5)].includes(r):n===r)}var Mt=t=>N(void 0,[`${t}.js`,`${t}.css`],!1);async function tt(t){let{entryPointsWithoutExtension:e,entryPointVirtualFiles:r}=await W(Object.keys(t)),n={...r,...k(t)},i=[...e,...Object.keys(t)],o=await(0,Et.serve)({servedir:"public",port:19815},{...$({virtualPathMappings:n}),entryPoints:Object.keys(r),sourcemap:"inline",outdir:"public"}),a=(0,U.createServer)((s,c)=>{let u=ce(i,s.url);if(u!=null){c.writeHead(200,{"Content-Type":"text/html"}),c.end(Mt(u));return}let d={hostname:o.host,port:o.port,path:s.url,method:s.method,headers:s.headers},l=(0,U.request)(d,p=>{if(p.statusCode===404){c.writeHead(200,{"Content-Type":"text/html"}),c.end(Mt("index"));return}c.writeHead(p.statusCode||200,p.headers),p.pipe(c,{end:!0})});s.pipe(l,{end:!0})}).listen(3e3);console.error("Serving at http://localhost:3000"),await o.wait,a.close()}var me={parseMarkdownHeaderTree:A,parseMarkdownTitle:st,compileMarkdownToReact:R};function kt(){console.error("Usage:"),console.error("- esbuild-script start: start the devserver."),console.error("- esbuild-script build: generate production build."),console.error("- esbuild-script ssg: generate static site."),console.error("- esbuild-script ssg --no-js: generate static site without JS."),console.error("- esbuild-script help: display command line usages.")}async function de(t){let e=process.argv[2]||"";switch(e){case"init":return await Z(),!0;case"start":return await tt(t),!0;case"ssg":return B(t,!0);case"build":return B(t,!1);case"help":case"--help":return kt(),!0;default:return console.error(`Unknown command: '${e}'`),kt(),!1}}async function Ht(t){let e=t?await t():{};try{await de(e)||(process.exitCode=1)}catch(r){console.error(r),process.exitCode=1}}0&&(module.exports={constants,utils});
})();
//# sourceMappingURL=api.js.map

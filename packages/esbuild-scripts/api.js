// @generated
/* eslint-disable */
// prettier-ignore
(() => {
var Ot=Object.create,F=Object.defineProperty;var Bt=Object.getOwnPropertyDescriptor;var Gt=Object.getOwnPropertyNames;var Ut=Object.getPrototypeOf,Jt=Object.prototype.hasOwnProperty;var pt=t=>F(t,"__esModule",{value:!0});var Yt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),tt=(t,e)=>{for(var r in e)F(t,r,{get:e[r],enumerable:!0})},qt=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Gt(e))!Jt.call(t,n)&&n!=="default"&&F(t,n,{get:()=>e[n],enumerable:!(r=Bt(e,n))||r.enumerable});return t},m=t=>qt(pt(F(t!=null?Ot(Ut(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var St=Yt(at=>{function A(t,e){if(typeof t=="string")return t;if(t){let r,n;if(Array.isArray(t)){for(r=0;r<t.length;r++)if(n=A(t[r],e))return n}else for(r in t)if(e.has(r))return A(t[r],e)}}function E(t,e,r){throw new Error(r?`No known conditions for "${e}" entry in "${t}" package`:`Missing "${e}" export in "${t}" package`)}function xt(t,e){return e===t?".":e[0]==="."?e:e.replace(new RegExp("^"+t+"/"),"./")}function Zt(t,e=".",r={}){let{name:n,exports:o}=t;if(o){let{browser:i,require:a,conditions:l=[]}=r,s=xt(n,e);if(s[0]!=="."&&(s="./"+s),typeof o=="string")return s==="."?o:E(n,s);let u=new Set(["default",...l]);u.add(a?"require":"import"),u.add(i?"browser":"node");let c,g,ut=!1;for(c in o){ut=c[0]!==".";break}if(ut)return s==="."?A(o,u)||E(n,s,1):E(n,s);if(g=o[s])return A(g,u)||E(n,s,1);for(c in o){if(g=c[c.length-1],g==="/"&&s.startsWith(c))return(g=A(o[c],u))?g+s.substring(c.length):E(n,s,1);if(g==="*"&&s.startsWith(c.slice(0,-1))&&s.substring(c.length-1).length>0)return(g=A(o[c],u))?g.replace("*",s.substring(c.length-1)):E(n,s,1)}return E(n,s)}}function te(t,e={}){let r=0,n,o=e.browser,i=e.fields||["module","main"];for(o&&!i.includes("browser")&&i.unshift("browser");r<i.length;r++)if(n=t[i[r]]){if(typeof n!="string")if(typeof n=="object"&&i[r]=="browser"){if(typeof o=="string"&&(n=n[o=xt(t.name,o)],n==null))return o}else continue;return typeof n=="string"?"./"+n.replace(/^\.?\//,""):n}}at.legacy=te;at.resolve=Zt});pt(exports);tt(exports,{constants:()=>ot,default:()=>It,utils:()=>_e});var R=t=>process.stderr.isTTY?e=>`[${t}m${e}[0m`:e=>e,T=R(31),$=R(32),dt=R(33),N=R(34),He=R(35),Me=R(36);var P=m(require("path")),lt=m(require("esbuild"));var kt=m(require("module")),d=m(require("path")),At=m(require("sass"));var ot={};tt(ot,{BUILD_PATH:()=>D,DOCS_PATH:()=>et,GENERATED_PAGES_PATH:()=>y,PAGES_PATH:()=>f,SSR_CSS_PATH:()=>nt,SSR_JS_PATH:()=>H,SSR_LICENSE_PATH:()=>rt,TEMPLATE_PATH:()=>V,VIRTUAL_PATH_PREFIX:()=>W,VIRTUAL_SERVER_ENTRY_PATH:()=>M});var w=m(require("path")),V=(0,w.join)(__dirname,"templates"),et=(0,w.join)("docs"),f=(0,w.join)("src","pages"),y=(0,w.join)("src","generated-pages"),H=(0,w.join)("build","__ssr.jsx"),rt=(0,w.join)("build","__ssr.jsx.LEGAL.txt"),nt=(0,w.join)("build","__ssr.css"),D="build",W="esbuild-scripts-internal/virtual/",M=`${W}__server__.jsx`;var it={};tt(it,{copyDirectoryContent:()=>O,copyFile:()=>C,emptyDirectory:()=>ft,ensureDirectory:()=>b,exists:()=>B,isDirectory:()=>G,readDirectory:()=>U,readFile:()=>J,remove:()=>k,writeFile:()=>S});var p=m(require("fs")),x=m(require("path")),_=(t,e)=>r=>r?e(r):t(),I=t=>new Promise((e,r)=>(0,p.readdir)(t,(n,o)=>n?r(n):e(o))),mt=async t=>Promise.all((await I(t)).flatMap(async e=>{let r=(0,x.join)(t,e);return await G(r)?[r,...await mt(r)]:[r]})).then(e=>e.flat()),O=async(t,e)=>{await b(e),await ft(e),await Promise.all((await I(t)).map(async r=>{let n=(0,x.join)(t,r),o=(0,x.join)(e,r);await G(n)?await O(n,o):await C(n,o)}))},C=(t,e)=>new Promise((r,n)=>(0,p.copyFile)(t,e,_(r,n))),ft=async t=>{let e=await I(t);await Promise.all(e.map(r=>k((0,x.join)(t,r))))},b=t=>new Promise((e,r)=>(0,p.mkdir)(t,{recursive:!0},_(e,r))),B=t=>new Promise(e=>(0,p.access)(t,void 0,r=>e(r==null))),G=t=>new Promise((e,r)=>(0,p.lstat)(t,(n,o)=>n?r(n):e(o.isDirectory()))),U=async(t,e)=>e?await B(t)?(await mt(t)).map(r=>(0,x.relative)(t,r)).sort((r,n)=>r.localeCompare(n)):[]:I(t),J=t=>new Promise((e,r)=>(0,p.readFile)(t,(n,o)=>n?r(n):e(o.toString()))),k=t=>new Promise((e,r)=>{p.readFile!=null?(0,p.rm)(t,{recursive:!0,force:!0},_(e,r)):G(t).then(n=>n?(0,p.rmdir)(t,{recursive:!0},_(e,r)):(0,p.unlink)(t,_(e,r))).catch(n=>r(n))}),S=(t,e)=>new Promise((r,n)=>(0,p.writeFile)(t,e,_(r,n)));var wt=m(require("@mdx-js/mdx")),yt=m(require("remark-slug"));function zt(t){if(t==null)throw new Error(`Value is asserted to be not null, but it is ${t}.`)}var st=t=>(zt(t),t);var gt=({level:t,label:e})=>`${"#".repeat(t)} ${e}`,Xt=t=>{let e=[],r=!1;return t.split(`
`).filter(o=>{if(o.startsWith("```"))r=!r;else return!r}).forEach(o=>{let i=o.trim();if(!i.startsWith("#"))return;let a=0;for(;i[a]==="#";)a+=1;if(a>6)throw new Error(`Invalid Header: '${i}'`);e.push({level:a,label:i.substring(a).trim()})}),e},ht=t=>{let e=Xt(t);if(e[0]==null)throw new Error("Lacking title.");if(e[0].level!==1)throw new Error(`First heading must be h1, found: ${gt(e[0])}`);if(e.filter(r=>r.level===1).length>1)throw new Error("More than one h1.");return e},Pt=(t,e)=>{let r=st(t[e]),n=[],o=e+1;for(;o<t.length;){let{element:i,level:a,finishedIndex:l}=Pt(t,o);if(a<=r.level)break;if(a>r.level+1){let s=gt({level:a,label:i.label});throw new Error(`Invalid header: ${s}. Expected Level: ${r.level+1}`)}o=l,n.push(i)}return{element:{label:r.label,children:n},level:r.level,finishedIndex:o}},Kt=t=>{let e=ht(t);return Pt(e,0).element},bt=t=>st(ht(t)[0]).label,Y=Kt;var Qt=async(t,e)=>{let r=t.trim().split(`
`).slice(1),n;if(e){let o=r.findIndex(i=>i.trimStart().startsWith("<!--")&&i.includes("truncate"));n=r.slice(0,o).join(`
`)}else n=r.join(`
`);return n=n.trim(),`import React from 'react';
import mdx from 'esbuild-scripts/__internal-components__/mdx';
${await(0,wt.default)(n,{remarkPlugins:[yt.default]})}
MDXContent.truncated = ${e};
MDXContent.toc = ${JSON.stringify(Y(t),void 0,2)};`},L=Qt;var vt=m(require("fs"));var q=m(require("fs")),h=m(require("path")),z=m(St()),ee=[".tsx",".ts",".jsx",".mjs",".cjs",".js",".json"],re=/^(\/|\.{1,2}(\/|$))/,ne=/^\.{0,2}\//,oe=(t,e,r)=>{let n=(0,z.resolve)(t,e,{browser:r,require:!r});if(n!=null)return n;let o=(0,z.legacy)(t,r?{browser:r}:{browser:!1,fields:["main","module"]});return typeof o=="string"?e==="."?o:null:o&&(o[e]||o[`${e}.js`]||o[`./${e}`]||o[`./${e}.js`])||null},ie=(t,e)=>{let r=(0,h.normalize)(t),n=(0,h.normalize)(e);return r===n?".":(r.endsWith(h.sep)||(r=r+h.sep),n.startsWith(r)?n.slice(r.length):null)},se=(t,e,r)=>{let n=e.findPackageLocator((0,h.join)(t,"internal.js"));if(n==null)throw new Error;let{packageLocation:o}=e.getPackageInformation(n),i=(0,h.join)(o,"package.json");if(!q.existsSync(i))return null;let a=JSON.parse(q.readFileSync(i,"utf8")),l=ie(o,t);if(l==null)throw new Error;ne.test(l)||(l=`./${l}`),l=(0,h.normalize)(l);let s=oe(a,l,r);return s!=null?(0,h.join)(o,s):null},ae=(t,e,r,n)=>{if(re.test(t))return e;let o=se(e,r,n);return o?(0,h.normalize)(o):e},le=(t,e,r,n)=>{let o=r.resolveToUnqualified(t,e);return o==null?null:r.resolveUnqualified(ae(t,o,r,n),{extensions:ee})},Et=le;var Rt=/()/,ce=()=>({name:"esbuild-scripts-esbuild-plugin-pnp",setup(t){let{findPnpApi:e}=require("module");if(typeof e=="undefined")return;let r=process.cwd();t.onResolve({filter:Rt},async n=>{let o=n.importer?n.importer:`${r}/`,i=e(o);if(!i)return;let a=n.path.lastIndexOf("?"),l=a===-1?n.path:n.path.substring(0,a),s=Et(l,o,i,t.initialOptions.platform!=="node");return s==null?{external:!0}:{namespace:"pnp",path:`${s}${a===-1?"":n.path.substring(a)}`}}),t.onLoad!==null&&t.onLoad({filter:Rt},async n=>({contents:await vt.promises.readFile(n.path,"utf8"),loader:"default"}))}}),Tt=ce;var $t=/^esbuild-scripts-internal\/virtual\//,ue=t=>({name:"VirtualPathResolvePlugin",setup(e){e.onResolve({filter:$t},r=>({path:r.path,namespace:"virtual-path"})),e.onLoad({filter:$t,namespace:"virtual-path"},r=>({contents:t[r.path],loader:"jsx"}))}}),_t=ue;var pe={name:"WebAppResolvePlugin",setup(t){t.onResolve({filter:/^data:/},()=>({external:!0})),t.onResolve({filter:/^esbuild-scripts-internal\/docs\//},e=>({path:(0,d.resolve)((0,d.join)(et,(0,d.relative)((0,d.join)("esbuild-scripts-internal","docs"),e.path)))})),t.onResolve({filter:/^esbuild-scripts-internal\/page\//},async e=>{let r=(0,d.relative)((0,d.join)("esbuild-scripts-internal","page"),e.path),n=[(0,d.join)(f,`${r}.js`),(0,d.join)(f,`${r}.jsx`),(0,d.join)(f,`${r}.ts`),(0,d.join)(f,`${r}.tsx`),(0,d.join)(y,`${r}.js`),(0,d.join)(y,`${r}.jsx`),(0,d.join)(y,`${r}.ts`),(0,d.join)(y,`${r}.tsx`)];for(let o of n)if(await B(o))return{path:(0,d.resolve)(o)};throw new Error(`Cannot found page at ${r}. Candidates considered:
${n.join(`
`)}`)})}},de={name:"sass",setup(t){t.onResolve({filter:/.\.(scss|sass)$/},async e=>e.path.startsWith(".")?{path:(0,d.resolve)((0,d.dirname)(e.importer),e.path)}:{path:(0,kt.createRequire)(e.importer).resolve(e.path)}),t.onLoad({filter:/.\.(scss|sass)$/},async e=>{let{css:r}=await new Promise((n,o)=>{(0,At.render)({file:e.path},(i,a)=>{i?o(i):n(a)})});return{contents:r.toString(),loader:"css",watchFiles:[e.path]}})}},me={name:"mdx",setup(t){t.onLoad({filter:/\.md\?truncated=true$/},async e=>({contents:await L(await J(e.path.substring(0,e.path.lastIndexOf("?"))),!0),loader:"jsx"})),t.onLoad({filter:/\.md$/},async e=>({contents:await L(await J(e.path),!1),loader:"jsx"}))}},fe=t=>[pe,_t(t),de,me,Tt()],Ht=fe;var ge=({virtualPathMappings:t,isServer:e=!1,isProd:r=!1})=>({define:{__dirname:'""',__SERVER__:String(e),"process.env.NODE_ENV":r?'"production"':'"development"'},bundle:!0,minify:!1,legalComments:"linked",platform:"browser",target:"es2019",logLevel:"error",plugins:Ht(t)}),j=ge;var X=m(require("path"));var Mt="// @generated",Ct=t=>t.endsWith("index")?t.substring(0,t.length-(t.endsWith("/index")?6:5)):t,he=(t,e,r)=>{let n=Ct(e),o=r.filter(u=>u!==e),i=o.map(Ct),a=o.map((u,c)=>`const Component${c} = lazy(() => import('esbuild-scripts-internal/page/${u}'));`).join(`
`),l=i.map((u,c)=>`<Route exact path="/${u}"><Suspense fallback={null}><Component${c} /></Suspense></Route>`).join(""),s=`<Switch><Route exact path="/${n}"><Page /></Route>${l}</Switch>`;return`${Mt}
import React,{Suspense,lazy} from 'react';
import {hydrate,render} from 'react-dom';
import {BrowserRouter,Route,Switch} from 'esbuild-scripts/__internal-components__/react-router';
import Document from '${t}/src/pages/_document';
import Page from 'esbuild-scripts-internal/page/${e}';
${a}
const element = <BrowserRouter><Document>${s}</Document></BrowserRouter>;const rootElement = document.getElementById('root');
if (rootElement.hasChildNodes()) hydrate(element, rootElement); else render(element, rootElement);
`},Pe=(t,e)=>`${Mt}
import React from 'react';
import {renderToString} from 'react-dom/server';
import Helmet from 'esbuild-scripts/components/Head';
import {StaticRouter} from 'esbuild-scripts/__internal-components__/react-router';
import Document from '${t}/src/pages/_document';
${e.map((r,n)=>`import Page${n} from 'esbuild-scripts-internal/page/${r}';`).join(`
`)}
const map = { ${e.map((r,n)=>`'${r}': Page${n}`).join(", ")} };
module.exports = (path) => ({
  divHTML: renderToString(
    <StaticRouter location={'/'+path}>
      <Document>{React.createElement(map[path])}</Document>
    </StaticRouter>
  ),
  noJS: map[path].noJS,
  helmet: Helmet.renderStatic(),
});
`,be=async()=>{await b(f);let[t,e]=await Promise.all([U(f,!0),U(y,!0)]);return[...t,...e].map(n=>{switch((0,X.extname)(n)){case".js":case".jsx":case".ts":case".tsx":break;default:return null}return n.substring(0,n.lastIndexOf("."))}).filter(n=>n!=null&&!n.startsWith("_document"))},K=async()=>{let t=(0,X.resolve)("."),e=await be(),r=Object.fromEntries(e.map(n=>[`${W}${n}.jsx`,he(t,n,e)]));return r[M]=Pe(t,e),{entryPointsWithoutExtension:e,entryPointVirtualFiles:r}};var we=(t,e)=>e?`<script type="module" src="/${t}"></script>`:`<script src="/${t}"></script>`,ye=(t,e)=>`<link rel="${e?"modulepreload":"preload"}" href="/${t}" />`,xe=(t,e,r)=>{let n=[],o=[];t.forEach(l=>{!r&&l.endsWith("js")?n.push(l):l.endsWith("css")&&o.push(l)});let i=o.map(l=>`<link rel="stylesheet" href="/${l}" />`).join("")+n.map(l=>ye(l,e)).join(""),a=n.map(l=>we(l,e)).join("");return{headLinks:i,bodyScriptLinks:a}},Lt=(t,e)=>e==null?`<head>${t}</head>`:`<head>${[e.meta.toString(),e.title.toString(),e.link.toString(),e.script.toString(),t].join("")}</head>`,Se=(t,e,r)=>{let{headLinks:n,bodyScriptLinks:o}=xe(e,r,t==null?void 0:t.noJS);if(t==null){let u=Lt(n),c=`<body><div id="root"></div>${o}</body>`;return`<!DOCTYPE html><html>${u}${c}</html>`}let{divHTML:i,helmet:a}=t,l=Lt(n,a),s=`<body><div id="root">${i}</div>${o}</body>`;return`<!DOCTYPE html><html ${a.htmlAttributes.toString()}>${l}${s}</html>`},Q=Se;var jt=async t=>{let{outputFiles:e}=await(0,lt.build)({...j({virtualPathMappings:t,isProd:!0}),entryPoints:Object.keys(t),assetNames:"assets/[name]-[hash]",chunkNames:"chunks/[name]-[hash]",entryNames:"[dir]/[name]-[hash]",minify:!0,format:"esm",splitting:!0,write:!1,outdir:"build"}),r=(0,P.resolve)("build");return await Promise.all(e.map(async n=>{await b((0,P.dirname)(n.path)),await S(n.path,n.contents)})),e.map(({path:n})=>(0,P.relative)(r,n))},Ee=async t=>{await(0,lt.build)({...j({virtualPathMappings:t,isServer:!0,isProd:!0}),entryPoints:[M],platform:"node",format:"cjs",outfile:H});try{return require((0,P.resolve)(H))}catch(e){return console.error(T("Unable to perform server side rendering since the server bundle is not correctly generated.")),console.error(T(e)),null}finally{await Promise.all([k(H),k(rt),k(nt)])}},ve=async t=>{let e=new Date().getTime();console.error(dt("[i] Bundling..."));let{entryPointsWithoutExtension:r,entryPointVirtualFiles:n}=await K();await O("public","build");let o,i;if(t){if([o,i]=await Promise.all([jt(n),Ee(n)]),i==null)return!1}else o=await jt(n),i=null;let a=r.map(s=>{let u=o.filter(g=>g.startsWith("chunk")||g.startsWith(s)),c=Q(i==null?void 0:i(s),u,!0);return{entryPoint:s,html:c}});await Promise.all(a.map(async({entryPoint:s,html:u})=>{let c;s.endsWith("index")?c=(0,P.join)(D,`${s}.html`):c=(0,P.join)(D,s,"index.html"),await b((0,P.dirname)(c)),await S(c,u)}));let l=new Date().getTime()-e;return console.error(`\u26A1 ${$(`Build success in ${l}ms.`)}`),!0},ct=ve;var v=m(require("path"));var Re=async()=>{await b(f),await Promise.all([C((0,v.join)(V,"_document.tsx"),(0,v.join)(f,"_document.tsx")),C((0,v.join)(V,"index.tsx"),(0,v.join)(f,"index.tsx")),S((0,v.join)(f,"index.css"),""),S((0,v.join)("src","types.d.ts"),`/// <reference types="esbuild-scripts" />
`),b("public")]),console.error($("esbuild-scripts app initialized."))},Ft=Re;var Z=m(require("http")),Nt=m(require("esbuild"));var Te=(t,e)=>{if(e==null||!e.startsWith("/"))return;let r=e.substring(1);return t.find(n=>n.endsWith("index")?[n,n.substring(0,n.length-5)].includes(r):n===r)},Vt=t=>Q(void 0,[`${t}.js`,`${t}.css`],!1),$e=async()=>{let{entryPointsWithoutExtension:t,entryPointVirtualFiles:e}=await K(),r=await(0,Nt.serve)({servedir:"public",port:19815},{...j({virtualPathMappings:e}),entryPoints:Object.keys(e),sourcemap:"inline",outdir:"public"}),n=(0,Z.createServer)((o,i)=>{let a=Te(t,o.url);if(a!=null){i.writeHead(200,{"Content-Type":"text/html"}),i.end(Vt(a));return}let l={hostname:r.host,port:r.port,path:o.url,method:o.method,headers:o.headers},s=(0,Z.request)(l,u=>{if(u.statusCode===404){i.writeHead(200,{"Content-Type":"text/html"}),i.end(Vt("index"));return}i.writeHead(u.statusCode||200,u.headers),u.pipe(i,{end:!0})});o.pipe(s,{end:!0})}).listen(3e3);console.error(`${$("Serving at")} ${N("http://localhost:3000")}`),await r.wait,n.close()},Dt=$e;var _e={...it,parseMarkdownHeaderTree:Y,parseMarkdownTitle:bt,compileMarkdownToReact:L};function Wt(){console.error(N("Usage:")),console.error("- esbuild-script start: start the devserver."),console.error("- esbuild-script build: generate production build."),console.error("- esbuild-script ssg: generate static site."),console.error("- esbuild-script ssg --no-js: generate static site without JS."),console.error("- esbuild-script help: display command line usages.")}async function ke(){let t=process.argv[2]||"";switch(t){case"init":return await Ft(),!0;case"start":return await Dt(),!0;case"ssg":return ct(!0);case"build":return ct(!1);case"help":case"--help":return Wt(),!0;default:return console.error(T(`Unknown command: '${t}'`)),Wt(),!1}}async function It(t){t&&await t();try{await ke()||(process.exitCode=1)}catch(e){console.error(T(e)),process.exitCode=1}}0&&(module.exports={constants,utils});
})();

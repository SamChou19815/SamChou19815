#!/usr/bin/env node
module.exports=function(e,t){"use strict";var n={};function __webpack_require__(t){if(n[t]){return n[t].exports}var o=n[t]={i:t,l:false,exports:{}};var r=true;try{e[t].call(o.exports,o,o.exports,__webpack_require__);r=false}finally{if(r)delete n[t]}o.l=true;return o.exports}__webpack_require__.ab=__dirname+"/";function startup(){return __webpack_require__(543)}return startup()}({89:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});const o=n(747);const r=n(622);const s=(e,t)=>o.statSync(e).mtime.getTime()>=t;const i=(e,t,n)=>{const i=r.resolve(r.join(e,t));const c=e=>{if(o.lstatSync(e).isFile()){return s(e,n)}return o.readdirSync(e).some(t=>c(r.join(e,t)))};return c(i)};t.default=i},102:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const r=n(747);const s=n(622);const i=o(n(89));const c=n(740);const a=(e,t,n)=>{const o=s.join(e,n);return i.default(e,t,r.existsSync(o)?r.statSync(o).mtime.getTime():0)};const u=()=>Array.from(c.workspaceInformation.entries()).filter(([,{workspaceLocation:e,codegenConfiguration:t}])=>{return t!=null&&t.sources.some(n=>a(e,n,t.output))}).map(([e])=>e);t.default=u},129:function(e){e.exports=require("child_process")},187:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const r=n(926);const s=n(969);const i=n(871);const c=o(n(478));const a=n(499);const u=()=>["ts-js",{workflowName:"TS and JS",workflowtrigger:{triggerPaths:[".github/workflows/generated-ts-js.yml","package.json","**/package.json","**.js","**.ts","**.jsx","**.tsx"],masterBranchOnly:false},workflowJobs:[{jobName:"lint",jobSteps:[...a.yarnWorkspaceBoilterplateSetupSteps,s.githubActionJobRunStep("Lint","yarn lint")]},{jobName:"build",jobSteps:[s.githubActionJobActionStep("actions/checkout@v2",{"fetch-depth":"2"}),i.GITHUB_ACTIONS_SETUP_NODE_STEP,i.GITHUB_ACTIONS_USE_YARN_CACHE_STEP,s.githubActionJobRunStep("Yarn Install","yarn install --immutable"),s.githubActionJobRunStep("Build","yarn compile")]},{jobName:"test",jobSteps:[...a.yarnWorkspaceBoilterplateSetupSteps,s.githubActionJobRunStep("Test","yarn test")]}]}];const l=()=>["generated-in-sync",{workflowName:"lint-generated",workflowtrigger:{triggerPaths:["**"],masterBranchOnly:false},workflowJobs:[{jobName:"lint",jobSteps:[i.GITHUB_ACTIONS_CHECKOUT_STEP,i.GITHUB_ACTIONS_SETUP_NODE_STEP,s.githubActionJobRunStep("Codegen",`${r.PROJECT_CONFIGURATION.binary} codegen`),s.githubActionJobRunStep("Check changed","git diff --quiet --exit-code")]}]}];const p={serviceName:"Generate GitHub Actions Workflow",generatedFilenamePattern:".github/workflows/generated-*",generatedCodeContentList:[u(),l(),...Object.entries(a.getYarnWorkspaceWorkflows(c.default))].map(([e,t])=>({pathForGeneratedCode:`.github/workflows/generated-${e}.yml`,generatedCode:s.githubActionWorkflowToString(t)}))};t.default=p},309:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});const o=n(129);const r=n(747);const s=n(622);const i=(e,t)=>{r.mkdirSync(s.dirname(t),{recursive:true});r.copyFileSync(e,t)};const c=e=>e.map(e=>e.includes(" ")?`"${e}"`:e).join(" ");const a=(e,t)=>{Object.entries(t).forEach(([t,n])=>{i(t,s.join("..",e,n))});console.log(`[✓] Synced files to target repository \`${e}\`.`);const n=s.resolve(s.join("..",e));if(o.spawnSync("git",["status","--porcelain"],{cwd:n}).stdout.toString().trim()===""){console.log(`[✓] Target repository \`${e}\` is already in a clean state. Skip.`);return}const r=Object.values(t);const a=[["git","checkout","-b",`monorail/sync-service/t-${(new Date).getTime()}`],["git","add",...r],["git","commit","-m",`[monorail-sync] Automatic file sync commit from ${s.basename(s.resolve("."))}`],["gh","pr","create","--fill"]];console.group(`[✓] Making a pull request for synchronized files in \`${e}\`.`);if(process.env.DRY_RUN){a.forEach(e=>console.log(`> ${c(e)}`));console.groupEnd();console.log(`[✓] DRY_RUN for making PR for \`${e}\` completed.`)}else{a.forEach(e=>{const t=c(e);console.group(`> ${t}`);const r=o.spawnSync(e[0],e.slice(1),{cwd:n});console.group();const s=(e,t)=>{const n=e.toString().trim();if(!n)return;n.split("\n").filter(Boolean).forEach(e=>t?console.error(e):console.log(e))};if(r.status!==0||process.env.INCLUDE_ERROR){s(r.stderr,true)}s(r.stdout,false);console.groupEnd();console.groupEnd();if(r.status!==0){throw new Error(`Failed to run: \`${e}\``)}});console.groupEnd();console.log(`\n[✓] Made a pull request for synchronized files in \`${e}\`.`)}};const u=()=>{const e=s.join("configuration","sync-configuration.json");if(!r.existsSync(e)){return}console.group("--- Monorail Cross-repository Sync Service ---");const t=JSON.parse(r.readFileSync(e).toString());Object.entries(t).forEach(([e,t])=>{console.group(`\nSynchronizing for \`${e}\`...`);a(e,t);console.groupEnd()});console.groupEnd();console.log(`\n[✓] Synchronized all files.`)};t.default=u},349:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});const o=n(747);const r=o.readFileSync(".gitignore");const s=o.readFileSync("configuration/styleignore.additions");const i=`# @generated\n\n${r}\n${s}`;const c={serviceName:"Generate ignore files derived from .gitignore",generatedCodeContentList:[{pathForGeneratedCode:".eslintignore",generatedCode:i},{pathForGeneratedCode:".prettierignore",generatedCode:i}]};t.default=c},370:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const r=n(129);const s=n(747);const i=o(n(187));const c=o(n(349));const a=o(n(485));const u=[i.default,c.default,a.default];const l=()=>{u.forEach(e=>{const{generatedFilenamePattern:t,generatedCodeContentList:n}=e;if(t!=null){r.spawnSync("rm",[t],{shell:true})}n.forEach(({pathForGeneratedCode:e,generatedCode:t})=>s.writeFileSync(e,t))})};t.default=l},463:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});const o=n(129);const r=n(747);const s=n(622);const i=n(713);const c=e=>{const{sources:t,output:n}=i.assertHasFields("codegenConfiguration",["sources","output"],e);return{sources:i.assertIsStringArray("sources",t),output:i.assertIsString("output",n)}};const a=()=>{const e=new Map;const t=o.spawnSync("yarn",["workspaces","list","-v","--json"],{shell:true});const n=t.stdout.toString().trim();const a=`[${n.split("\n").join(",")}]`;const u=JSON.parse(a);u.forEach(({name:t,location:n,workspaceDependencies:o})=>{var a;if(t==null){return}const u=o.map(e=>{if(!e.startsWith("packages/")){throw new Error(`Bad dependency of ${t}: ${e}`)}return e.substring("packages/".length)});const l=JSON.parse(r.readFileSync(s.join(n,"package.json")).toString());e.set(t,{workspaceLocation:n,hasCompileScript:((a=l.scripts)===null||a===void 0?void 0:a.compile)!=null,inRepoWorkspaceDependencies:u,githubRepositoryDependencies:i.assertIsStringArray("githubRepositoryDependencies",l.githubRepositoryDependencies,true),deploymentDependencies:i.assertIsStringArray("deploymentDependencies",l.deploymentDependencies,true),codegenConfiguration:l.codegenConfiguration==null?undefined:c(l.codegenConfiguration)})});return e};t.default=a},477:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});const o=n(926);const r=e=>{const t=[];const n=[];const r=[];e.forEach(e=>{if(o.PROJECT_CONFIGURATION.toolingPrefixes.some(t=>e.startsWith(t))){t.push(e)}else if(e.startsWith("lib-")){n.push(e)}else{r.push(e)}});return{toolingWorkspaces:t,libraryWorkspaces:n,projectWorkspaces:r}};t.default=r},478:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});const n={};t.default=n},485:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});const o=n(740);const r={serviceName:"Generate static json",generatedCodeContentList:[{pathForGeneratedCode:"configuration/libraries.json",generatedCode:`${JSON.stringify(o.libraryWorkspaces,undefined,2)}\n`}]};t.default=r},499:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getYarnWorkspaceWorkflows=t.yarnWorkspaceBoilterplateSetupSteps=void 0;const o=n(926);const r=n(740);const s=n(969);const i=n(871);t.yarnWorkspaceBoilterplateSetupSteps=[i.GITHUB_ACTIONS_CHECKOUT_STEP,i.GITHUB_ACTIONS_SETUP_NODE_STEP,i.GITHUB_ACTIONS_USE_YARN_CACHE_STEP,s.githubActionJobRunStep("Yarn Install","yarn install --immutable")];const c=e=>[...r.getYarnWorkspaceInRepoDependencyChain(e).map(e=>`${r.getYarnWorkspaceLocation(e)}/**`),"configuration/**",`.github/workflows/generated-*-${e}.yml`];const a=(e,n)=>({workflowName:`CD ${e}`,workflowtrigger:{triggerPaths:c(e),masterBranchOnly:true},workflowSecrets:o.PROJECT_CONFIGURATION.deploymentSecrets,workflowJobs:[{jobName:"deploy",jobSteps:[...r.getYarnWorkspaceGitHubRepositoryDependencies(e).map(i.getGitHubRepositoryDependencySetupSteps).flat(),...r.getYarnWorkspaceDeploymentDependencies(e).map(i.getDeploymentDependencySetupStep),...t.yarnWorkspaceBoilterplateSetupSteps,...n,s.githubActionJobRunStep("Build",`yarn workspace ${e} build`),s.githubActionJobRunStep("Deploy",`yarn workspace ${e} deploy`)]}]});t.getYarnWorkspaceWorkflows=((e={})=>Object.fromEntries([...r.projectWorkspaces.map(t=>{var n;const o=`cd-${t}`;return[o,a(t,(n=e[o])!==null&&n!==void 0?n:[])]})]))},529:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){function adopt(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function fulfilled(e){try{step(o.next(e))}catch(e){r(e)}}function rejected(e){try{step(o["throw"](e))}catch(e){r(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())})};var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=n(129);const i=r(n(102));const c=()=>o(void 0,void 0,void 0,function*(){console.log("--- Monorail Cached Build Service ---");const e=i.default();if(e.length===0){console.log("[✓] No need to rebuild!");return}console.group(`[${e.join(", ")}] needs to be rebuilt!`);const t=e.map(e=>{console.log(`Rebuiding \`${e}\`...`);return[e,s.spawnSync("yarn",["workspace",e,"codegen"],{stdio:["inherit",process.env.INCLUDE_ERROR?"inherit":"ignore","inherit"]}).status===0]});console.groupEnd();const n=t.filter(([,e])=>!e).map(([e])=>e);if(n.length===0){console.log("[✓] All workspaces have been successfully rebuilt!");return}throw new Error(`[x] [${n.join(", ")}] failed to exit with 0`)});t.default=c},543:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){function adopt(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function fulfilled(e){try{step(o.next(e))}catch(e){r(e)}}function rejected(e){try{step(o["throw"](e))}catch(e){r(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())})};var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});try{process.chdir(n(926).PROJECT_ROOT_DIRECTORY)}catch(e){console.error(e.message);process.exit(1)}const s=r(n(529));const i=r(n(549));const c=r(n(370));const a=r(n(793));const u=r(n(309));const l=()=>o(void 0,void 0,void 0,function*(){try{switch(i.default()){case"CODEGEN":c.default();return;case"COMPILE":yield a.default();return;case"REBUILD":yield s.default();return;case"SYNC":u.default();return;default:throw new Error}}catch(e){console.error(e.message);process.exit(1)}});l()},549:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});const n=()=>{const e=process.argv.slice(2);if(e.length===0){return"CODEGEN"}switch(e[0].toLowerCase()){case"codegen":return"CODEGEN";case"compile":case"c":return"COMPILE";case"rebuild":case"r":return"REBUILD";case"sync":case"s":return"SYNC";default:throw new Error(`Unknown command: ${e[0]}`)}};t.default=n},622:function(e){e.exports=require("path")},713:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.assertHasFields=t.assertIsStringArray=t.assertIsString=void 0;t.assertIsString=((e,t)=>{if(typeof t!=="string"){throw new Error(`Expect '${e}' to be a string!`)}return t});t.assertIsStringArray=((e,t,n=false)=>{if(n&&t==null){return[]}if(t==null||!Array.isArray(t)){throw new Error(`Expect '${e}' to be a string array!`)}const o=t.filter(e=>typeof e==="string");if(o.length!==t.length){throw new Error(`Expect '${e}' to be a string array!`)}return o});t.assertHasFields=((e,t,n)=>{if(n==null){throw new Error(`Expect '${e}' to be an object, but got undefined or null!`)}if(typeof n!=="object"){throw new Error(`Expect '${e}' to be an object, but got ${typeof n}!`)}const o={};const r=t.filter(e=>{const t=n[e];if(t!=null){o[e]=t}return t==null});if(r.length>0){throw new Error(`'${e}' has missing fields: [${r.join(", ")}]`)}return o})},740:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};var r;Object.defineProperty(t,"__esModule",{value:true});t.getYarnWorkspaceDeploymentDependencies=t.getYarnWorkspaceGitHubRepositoryDependencies=t.getYarnWorkspacesInTopologicalOrder=t.getYarnWorkspaceInRepoDependencyChain=t.getYarnWorkspaceHasCompileScript=t.getYarnWorkspaceLocation=t.projectWorkspaces=t.libraryWorkspaces=t.toolingWorkspaces=t.workspaceInformation=void 0;const s=o(n(463));const i=o(n(477));t.workspaceInformation=s.default();r=i.default(Array.from(t.workspaceInformation.keys())),t.toolingWorkspaces=r.toolingWorkspaces,t.libraryWorkspaces=r.libraryWorkspaces,t.projectWorkspaces=r.projectWorkspaces;const c=e=>{const n=t.workspaceInformation.get(e);if(n==null){throw new Error(`Workspace ${e} is not found!`)}return n};t.getYarnWorkspaceLocation=(e=>c(e).workspaceLocation);t.getYarnWorkspaceHasCompileScript=(e=>c(e).hasCompileScript);t.getYarnWorkspaceInRepoDependencyChain=(e=>{const t=[];const n=[];const o=new Set;const r=new Set;const s=e=>{if(r.has(e)){if(!o.has(e)){return}n.push(e);const t=n.indexOf(e);const r=n.slice(t,n.length).join(" -> ");throw new Error(`Cyclic dependency detected: ${r}`)}const i=c(e).inRepoWorkspaceDependencies;r.add(e);n.push(e);o.add(e);i.forEach(s);o.delete(e);n.pop();t.push(e)};s(e);return t});t.getYarnWorkspacesInTopologicalOrder=(()=>{const e=[];const n=new Set;Array.from(t.workspaceInformation.keys()).forEach(o=>{const r=t.getYarnWorkspaceInRepoDependencyChain(o);r.forEach(t=>{if(!n.has(t)){e.push(t);n.add(t)}})});return e});t.getYarnWorkspaceGitHubRepositoryDependencies=(e=>c(e).githubRepositoryDependencies);t.getYarnWorkspaceDeploymentDependencies=(e=>c(e).deploymentDependencies)},747:function(e){e.exports=require("fs")},793:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){function adopt(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function fulfilled(e){try{step(o.next(e))}catch(e){r(e)}}function rejected(e){try{step(o["throw"](e))}catch(e){r(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())})};var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=n(129);const i=r(n(89));const c=n(740);const a=n(831);const u=()=>o(void 0,void 0,void 0,function*(){console.log("--- Monorail Incremental Compile Service ---");const e=a.getIncrementalCompileLastRunTime();const t=t=>i.default(c.getYarnWorkspaceLocation(t),".",e);const n=e=>s.spawnSync("git",["diff","HEAD^","HEAD","--name-only",c.getYarnWorkspaceLocation(e)]).stdout.toString().trim().length>0;const o=process.env.CI?n:t;const r=c.getYarnWorkspacesInTopologicalOrder().filter(c.getYarnWorkspaceHasCompileScript).filter(o);if(r.length===0){console.log("[✓] Nothing needs to be recompiled!");return}console.group(`[${r.join(", ")}] needs to be re-compiled!`);const u=yield Promise.all(r.map(e=>{console.log(`Compiling \`${e}\`...`);const t=s.spawn("yarn",["workspace",e,"compile"]);return new Promise(n=>{t.on("exit",t=>n([e,t===0]))})}));console.groupEnd();const l=u.filter(([,e])=>!e).map(([e])=>e);if(l.length===0){console.log("[✓] All workspaces have been successfully compiled!");a.setIncrementalCompileLastRunTime();return}throw new Error(`[x] [${l.join(", ")}] failed to exit with 0`)});t.default=u},831:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.setIncrementalCompileLastRunTime=t.getIncrementalCompileLastRunTime=void 0;const o=n(747);const r=n(622);const s=r.join(".monorail","incremental-compile.json");t.getIncrementalCompileLastRunTime=(()=>{if(!o.existsSync(s)){return 0}return Number(JSON.parse(o.readFileSync(s).toString()).lastRunTime)});t.setIncrementalCompileLastRunTime=(()=>{o.mkdirSync(r.dirname(s),{recursive:true});o.writeFileSync(s,JSON.stringify({lastRunTime:(new Date).getTime()},undefined,2))})},871:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getDeploymentDependencySetupStep=t.getGitHubRepositoryDependencySetupSteps=t.GITHUB_ACTIONS_USE_YARN_CACHE_STEP=t.GITHUB_ACTIONS_SETUP_NODE_STEP=t.GITHUB_ACTIONS_CHECKOUT_STEP=void 0;const o=n(926);const r=n(969);t.GITHUB_ACTIONS_CHECKOUT_STEP=r.githubActionJobActionStep("actions/checkout@v2");t.GITHUB_ACTIONS_SETUP_NODE_STEP=r.githubActionJobActionStep("actions/setup-node@v2-beta");t.GITHUB_ACTIONS_USE_YARN_CACHE_STEP=r.githubActionJobActionStep("actions/cache@v2",{path:".yarn/cache\n.pnp.js",key:"yarn-berry-${{ hashFiles('**/yarn.lock') }}","restore-keys":"yarn-berry-"});t.getGitHubRepositoryDependencySetupSteps=(e=>[r.githubActionJobRunStep(`Checkout ${o.PROJECT_CONFIGURATION.organizationName}/${e}`,`cd ../ && git clone https://\${{ secrets.GH_TOKEN }}@github.com/${o.PROJECT_CONFIGURATION.organizationName}/${e} --depth 1`),r.githubActionJobRunStep(`Sanity Check ${e} setup`,`cat ../${e}/README.md`)]);const s=r.githubActionJobRunStep("Install firebase-tools","yarn global add firebase-tools");const i=r.githubActionJobActionStep("GoogleCloudPlatform/github-actions/setup-gcloud@master",{project_id:"${{ secrets.GCP_PROJECT_ID }}",service_account_key:"${{ secrets.GCP_SERVICE_ACCOUNT_KEY }}",export_default_credentials:"true"});t.getDeploymentDependencySetupStep=(e=>{switch(e){case"firebase-tools":return s;case"gcloud":return i;default:throw new Error(`Unsupported deployment dependency: ${e}`)}})},926:function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:true});t.PROJECT_CONFIGURATION=t.PROJECT_ROOT_DIRECTORY=void 0;const r=n(747);const s=n(622);const i=n(713);const c=e=>{const{binary:t,organizationName:n,toolingPrefixes:o,deploymentSecrets:r}=i.assertHasFields("repoToolsConfiguration",["binary","organizationName","toolingPrefixes","deploymentSecrets"],e);return{binary:i.assertIsString("binary",t),organizationName:i.assertIsString("organizationName",n),toolingPrefixes:i.assertIsStringArray("toolingPrefixes",o),deploymentSecrets:i.assertIsStringArray("deploymentSecrets",r)}};const a=()=>{let e=process.cwd();while(e!=="/"){const t=s.join(e,"package.json");if(r.existsSync(t)&&r.lstatSync(t).isFile()){const n=JSON.parse(r.readFileSync(t).toString());if(Array.isArray(n.workspaces)){return[e,c(n.repoToolsConfiguration)]}}e=s.dirname(e)}throw new Error("No configuration found. Abort!")};o=a(),t.PROJECT_ROOT_DIRECTORY=o[0],t.PROJECT_CONFIGURATION=o[1]},969:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.githubActionWorkflowToString=t.githubActionJobRunStep=t.githubActionJobActionStep=void 0;t.githubActionJobActionStep=((e,t={})=>({type:"use-action",actionName:e,actionArguments:t}));t.githubActionJobRunStep=((e,t)=>({type:"run",stepName:e,command:t}));const n=e=>{switch(e.type){case"use-action":{const t=`      - uses: ${e.actionName}\n`;if(Object.keys(e.actionArguments).length===0){return t}const n=Object.entries(e.actionArguments).map(([e,t])=>{const n=t.split("\n");if(n.length===1){return`          ${e}: ${n[0]}`}return`          ${e}: |\n${n.map(e=>`            ${e}`).join("\n")}`}).join("\n");return`${t}        with:\n${n}\n`}case"run":{const t=`      - name: ${e.stepName}\n`;const n=e.command.split("\n");if(n.length===1){return`${t}        run: ${n[0]}\n`}return`${t}        run: |\n${n.map(e=>`          ${e}\n`).join("")}`}default:throw new Error}};const o=({jobName:e,jobSteps:t})=>{return`  ${e}:\n    runs-on: ubuntu-latest\n    steps:\n${t.map(n).join("")}`};t.githubActionWorkflowToString=(({workflowName:e,workflowtrigger:{triggerPaths:t,masterBranchOnly:n},workflowSecrets:r=[],workflowJobs:s})=>{const i=`# @generated\n\nname: ${e}\non:\n  push:\n    paths:\n${t.map(e=>`      - '${e}'\n`).join("")}${n?`    branches:\n      - master\n`:""}${r.length>0?`env:\n${r.map(e=>`  ${e}: \${{ secrets.${e} }}`).join("\n")}\n`:""}\njobs:\n${s.map(o).join("")}`;return i})}});